{% extends 'base.html' %}

{% block title %}ãƒ•ãƒ¬ãƒ³ãƒ‰ - Moon Tasker{% endblock %}

{% block content %}
<h1 class="page-title">ãƒ•ãƒ¬ãƒ³ãƒ‰ ğŸ‘¥</h1>

{% if is_logged_in %}
<!-- ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ -->

<div class="card">
    <h2 class="section-title">ğŸ‘¤ ã‚ãªãŸã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</h2>
    {% if user_profile %}
    <div class="flex items-center gap-4">
        <div
            style="width: 64px; height: 64px; background: linear-gradient(135deg, #7c4dff, #ff6b9d); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px;">
            ğŸ‘¤
        </div>
        <div>
            <p style="font-weight: 600; font-size: 18px;">{{ user_profile.display_name or 'ãƒ¦ãƒ¼ã‚¶ãƒ¼' }}</p>
            <p class="text-muted text-sm">ID: {{ user_profile.friend_code or 'æœªè¨­å®š' }}</p>
        </div>
    </div>
    {% endif %}
</div>

<div class="card">
    <h2 class="section-title">ğŸ‘¥ ãƒ•ãƒ¬ãƒ³ãƒ‰ä¸€è¦§</h2>

    {% if friends_list|length == 0 %}
    <div class="text-center" style="padding: 32px;">
        <span style="font-size: 48px;">ğŸ‘¥</span>
        <p class="text-muted mt-4">ã¾ã ãƒ•ãƒ¬ãƒ³ãƒ‰ãŒã„ã¾ã›ã‚“</p>
    </div>
    {% else %}
    {% for friend in friends_list %}
    <div class="list-item">
        <div
            style="width: 48px; height: 48px; background: linear-gradient(135deg, #00bcd4, #64b5f6); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px;">
            ğŸ‘¤
        </div>
        <div style="flex: 1;">
            <p style="font-weight: 500;">{{ friend.display_name or 'ãƒ•ãƒ¬ãƒ³ãƒ‰' }}</p>
            <p class="text-muted text-sm">ç´¯è¨ˆã‚¿ã‚¹ã‚¯: {{ friend.total_tasks or 0 }}</p>
        </div>
    </div>
    {% endfor %}
    {% endif %}
</div>

<div class="card">
    <h2 class="section-title">â• ãƒ•ãƒ¬ãƒ³ãƒ‰ã‚’è¿½åŠ </h2>
    <form action="/friends/add" method="post" class="flex gap-4">
        <input type="text" name="friend_code" placeholder="ãƒ•ãƒ¬ãƒ³ãƒ‰ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›" class="form-input" style="flex: 1;">
        <button type="submit" class="btn btn-primary">è¿½åŠ </button>
    </form>
</div>

<div class="text-center">
    <form action="/friends/logout" method="post">
        <button type="submit" class="text-muted" style="background: none; border: none; cursor: pointer;">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
    </form>
</div>

{% else %}
<!-- æœªãƒ­ã‚°ã‚¤ãƒ³ -->

<div class="card text-center" style="padding: 48px;">
    <span style="font-size: 64px;">ğŸ‘¥</span>
    <h2 class="page-title mt-4">ãƒ•ãƒ¬ãƒ³ãƒ‰æ©Ÿèƒ½ã‚’ä½¿ã†</h2>
    <p class="text-muted mt-2">ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãƒ•ãƒ¬ãƒ³ãƒ‰ã¨é€²æ—ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†ï¼</p>
</div>

<div class="card">
    <h2 class="section-title">ğŸ” ãƒ­ã‚°ã‚¤ãƒ³</h2>

    <form action="/friends/login" method="post">
        <div class="form-group">
            <input type="email" name="email" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" required class="form-input">
        </div>
        <div class="form-group">
            <input type="password" name="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" required class="form-input">
        </div>
        <button type="submit" class="btn btn-primary w-full">ãƒ­ã‚°ã‚¤ãƒ³</button>
    </form>

    <div style="position: relative; margin: 24px 0;">
        <div style="border-top: 1px solid var(--color-border); position: absolute; inset: 0; top: 50%;"></div>
        <div style="position: relative; text-align: center;">
            <span class="text-muted text-sm" style="background: rgba(30, 58, 95, 0.6); padding: 0 16px;">ã¾ãŸã¯</span>
        </div>
    </div>

    <form action="/friends/signup" method="post">
        <div class="form-group">
            <input type="email" name="email" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" required class="form-input">
        </div>
        <div class="form-group">
            <input type="password" name="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ6æ–‡å­—ä»¥ä¸Šï¼‰" required class="form-input">
        </div>
        <button type="submit" class="btn btn-secondary w-full">æ–°è¦ç™»éŒ²</button>
    </form>
</div>

<div class="text-center">
    <a href="/" class="text-muted">â† ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ç¶šã‘ã‚‹</a>
</div>
{% endif %}
{% endblock %}