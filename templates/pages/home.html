{% extends 'base.html' %}

{% block title %}ãƒ›ãƒ¼ãƒ  - Moon Tasker{% endblock %}

{% block content %}
<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<div class="flex justify-between items-center mb-6">
    <h1 class="page-title">Moon Tasker</h1>
    <div class="flex items-center gap-2">
        <span style="font-size: 24px;">{{ moon_emoji }}</span>
        <span class="text-muted">{{ moon_phase }}</span>
    </div>
</div>

<!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚«ãƒ¼ãƒ‰ -->
<div class="card" style="cursor: pointer;">
    <div class="card-header">
        <div class="icon success">â–¶ï¸</div>
        <div style="flex: 1;">
            <h2 class="section-title" style="margin-bottom: 4px;">ä»Šã™ãå§‹ã‚ã‚‹</h2>
            <p class="text-muted text-sm">25åˆ†é–“ã®é›†ä¸­ã‚¿ã‚¤ãƒ ã‚’é–‹å§‹</p>
        </div>
        <a href="/timer?quick=true" class="btn btn-success">ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ</a>
    </div>
</div>

<!-- ç”Ÿå‘½ä½“ã‚«ãƒ¼ãƒ‰ -->
{% if creature %}
<div class="card" style="border-left: 4px solid 
    {% if creature.mood >= 70 %}#64b5f6
    {% elif creature.mood >= 40 %}#ffc107
    {% elif creature.mood >= 20 %}#ff9800
    {% else %}#f44336{% endif %};">

    <div class="flex gap-6">
        <!-- ç”Ÿå‘½ä½“ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ« -->
        <div class="text-center">
            {% if creature_image %}
            <img src="{{ creature_image }}" alt="{{ creature.name }}"
                style="width: 100px; height: 100px; object-fit: contain;">
            {% else %}
            <div style="font-size: 64px;">ğŸ¥š</div>
            {% endif %}
            <p class="text-muted text-sm">Lv.{{ creature.evolution_stage }}</p>
        </div>

        <!-- æƒ…å ± -->
        <div style="flex: 1;">
            <div class="flex items-center gap-2 mb-2">
                <h3 style="font-size: 18px; font-weight: 600;">{{ creature.name }}</h3>
                <span class="text-xs" style="padding: 4px 8px; border-radius: 20px;
                    {% if creature.mood >= 70 %}background: rgba(100, 181, 246, 0.2); color: #64b5f6;
                    {% elif creature.mood >= 40 %}background: rgba(255, 193, 7, 0.2); color: #ffc107;
                    {% elif creature.mood >= 20 %}background: rgba(255, 152, 0, 0.2); color: #ff9800;
                    {% else %}background: rgba(244, 67, 54, 0.2); color: #f44336;{% endif %}">
                    {% if creature.mood >= 70 %}ã”ãã’ã‚“{% elif creature.mood >= 40 %}ãµã¤ã†{% elif creature.mood >= 20
                    %}ã•ã³ã—ã„{% else %}ãã‘ã‚“{% endif %}
                </span>
            </div>

            {% if emotion and emotion.speech %}
            <div class="creature-speech">
                <p>ã€Œ{{ emotion.speech }}ã€</p>
            </div>
            {% endif %}

            {% if emotion and emotion.desc %}
            <p class="text-muted text-sm mt-2" style="font-style: italic;">ï¼ˆ{{ emotion.desc }}ï¼‰</p>
            {% endif %}

            {% if warning %}
            <p style="color: #f44336; font-weight: 600; margin-top: 8px;">{{ warning }}</p>
            {% endif %}

            <!-- æ©Ÿå«Œãƒ¡ãƒ¼ã‚¿ãƒ¼ -->
            <div class="mt-4">
                <div class="flex justify-between text-xs text-muted mb-2">
                    <span>æ©Ÿå«Œ</span>
                    <span>{{ creature.mood }}%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-bar-fill 
                        {% if creature.mood >= 70 %}mood-high
                        {% elif creature.mood >= 40 %}mood-medium
                        {% elif creature.mood >= 20 %}mood-low
                        {% else %}mood-danger{% endif %}" style="width: {{ creature.mood }}%;"></div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
<div class="stats-grid">
    <div class="card stat-card">
        <h3 class="text-muted text-sm mb-4">ğŸ“Š ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯</h3>
        <div class="flex items-center justify-center gap-4">
            <div>
                <p class="stat-value yellow">{{ pending_count }}</p>
                <p class="stat-label">æœªå®Œäº†</p>
            </div>
            <span style="font-size: 24px; color: #666;">/</span>
            <div>
                <p class="stat-value green">{{ completed_count }}</p>
                <p class="stat-label">å®Œäº†</p>
            </div>
        </div>
    </div>

    <div class="card stat-card">
        <h3 class="text-muted text-sm mb-4">
            {% if streak_data.current_streak > 0 %}ğŸ”¥{% else %}ğŸ’¤{% endif %} é€£ç¶šè¨˜éŒ²
        </h3>
        <p class="stat-value {% if streak_data.current_streak > 0 %}orange{% else %}text-muted{% endif %}">
            {{ streak_data.current_streak }}
        </p>
        <p class="stat-label">æ—¥é€£ç¶š</p>
        <p class="text-xs text-muted mt-2">
            æœ€é«˜: {{ streak_data.max_streak }}æ—¥ / ç´¯è¨ˆ: {{ streak_data.total_days }}æ—¥
        </p>
    </div>
</div>

<!-- ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ³ã‚¯ -->
<div class="quick-links">
    <a href="/timer" class="card quick-link">
        <span class="icon">â±ï¸</span>
        <p class="label">ã‚¿ã‚¤ãƒãƒ¼</p>
    </a>
    <a href="/playlist" class="card quick-link">
        <span class="icon">ğŸ“</span>
        <p class="label">ã‚¿ã‚¹ã‚¯ç®¡ç†</p>
    </a>
    <a href="/creature" class="card quick-link">
        <span class="icon">ğŸ¾</span>
        <p class="label">ç”Ÿå‘½ä½“</p>
    </a>
</div>
{% endblock %}