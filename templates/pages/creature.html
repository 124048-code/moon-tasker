{% extends 'base.html' %}

{% block title %}ç”Ÿå‘½ä½“ - Moon Tasker{% endblock %}

{% block content %}
<h1 class="page-title">ç”Ÿå‘½ä½“ ğŸ¾</h1>

{% if creature %}
<!-- ç”Ÿå‘½ä½“è¡¨ç¤º -->
<div class="card text-center" style="border: 2px solid 
    {% if creature.mood >= 70 %}rgba(100, 181, 246, 0.5)
    {% elif creature.mood >= 40 %}rgba(255, 193, 7, 0.5)
    {% elif creature.mood >= 20 %}rgba(255, 152, 0, 0.5)
    {% else %}rgba(244, 67, 54, 0.5){% endif %}; padding: 40px;">

    <p class="text-muted text-sm mb-4">ã‚ãªãŸã®ç›¸æ£’</p>

    <div class="creature-emoji">{{ emoji }}</div>

    <h2 style="font-size: 24px; font-weight: 700;">{{ creature.name }}</h2>
    <p class="text-muted">Lv.{{ creature.evolution_stage }}</p>

    {% if emotion %}
    <div class="creature-speech mt-4">
        <p style="font-size: 16px;">ã€Œ{{ emotion.speech }}ã€</p>
    </div>
    <p class="text-muted text-sm mt-2" style="font-style: italic;">ï¼ˆ{{ emotion.desc }}ï¼‰</p>
    {% endif %}

    {% if warning %}
    <p style="color: #f44336; font-weight: 600; margin-top: 16px;">âš ï¸ {{ warning }}</p>
    {% endif %}

    <div class="creature-mood mt-6">
        <div class="flex justify-between text-sm text-muted mb-2">
            <span>æ©Ÿå«Œ</span>
            <span>{{ creature.mood }}%</span>
        </div>
        <div class="progress-bar" style="height: 12px;">
            <div class="progress-bar-fill 
                {% if creature.mood >= 70 %}mood-high
                {% elif creature.mood >= 40 %}mood-medium
                {% elif creature.mood >= 20 %}mood-low
                {% else %}mood-danger{% endif %}" style="width: {{ creature.mood }}%;"></div>
        </div>
    </div>
</div>

<!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
<div class="stats-grid">
    <div class="card stat-card">
        <p class="stat-value purple">{{ creature.evolution_stage }}</p>
        <p class="stat-label">é€²åŒ–æ®µéš</p>
    </div>
    <div class="card stat-card">
        <p class="stat-value green">{{ creature.experience if creature.experience else 0 }}</p>
        <p class="stat-label">ç´¯è¨ˆçµŒé¨“å€¤</p>
    </div>
</div>

{% if evolution_history|length > 0 %}
<div class="card">
    <h3 class="section-title">ğŸŒŸ é€²åŒ–ã®è»Œè·¡</h3>
    <div class="flex justify-center items-center gap-2" style="flex-wrap: wrap;">
        {% for stage in evolution_history %}
        <div class="text-center"
            style="padding: 12px; background: rgba(10, 10, 26, 0.5); border-radius: 12px; border: 1px solid var(--color-border);">
            <span style="font-size: 32px;">{{ stage.emoji }}</span>
            <p class="text-xs text-muted mt-2">{{ stage.name }}</p>
        </div>
        {% if not loop.last %}
        <span style="font-size: 24px; color: #666;">â†’</span>
        {% endif %}
        {% endfor %}
    </div>
</div>
{% endif %}

{% else %}
<!-- æ–°è¦è‚²æˆé–‹å§‹ -->
<div class="card text-center" style="padding: 48px;">
    <span style="font-size: 80px; display: block;">ğŸ¥š</span>
    <h2 class="page-title mt-4">ç”Ÿå‘½ä½“ã‚’è‚²ã¦ã‚ˆã†ï¼</h2>
    <p class="text-muted mt-2">ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã—ã¦çµŒé¨“å€¤ã‚’è²¯ã‚ã€ç”Ÿå‘½ä½“ã‚’é€²åŒ–ã•ã›ã¾ã—ã‚‡ã†</p>

    <form action="/creature/start" method="post" class="mt-6">
        <input type="text" name="name" placeholder="åå‰ã‚’å…¥åŠ›" value="ãƒ«ãƒŠ" class="form-input text-center"
            style="max-width: 240px; display: inline-block;">
        <br>
        <button type="submit" class="btn btn-primary mt-4">ğŸ¥š è‚²æˆé–‹å§‹</button>
    </form>
</div>

<div class="card">
    <h3 class="section-title">ğŸ’¡ è‚²æˆã®ãƒ’ãƒ³ãƒˆ</h3>
    <div style="display: grid; gap: 12px;">
        <div class="flex items-center gap-4">
            <span style="font-size: 24px;">ğŸ¯</span>
            <p>ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã™ã‚‹ã¨çµŒé¨“å€¤ãŒè²¯ã¾ã‚Šã¾ã™</p>
        </div>
        <div class="flex items-center gap-4">
            <span style="font-size: 24px;">â±ï¸</span>
            <p>é›£ã—ã„ã‚¿ã‚¹ã‚¯ã»ã©å¤šãã®çµŒé¨“å€¤ãŒã‚‚ã‚‰ãˆã¾ã™</p>
        </div>
        <div class="flex items-center gap-4">
            <span style="font-size: 24px;">ğŸŒŸ</span>
            <p>çµŒé¨“å€¤ãŒä¸€å®šé‡ã«é”ã™ã‚‹ã¨é€²åŒ–ã—ã¾ã™</p>
        </div>
        <div class="flex items-center gap-4">
            <span style="font-size: 24px;">ğŸ˜¢</span>
            <p>é•·æ™‚é–“ã‚¿ã‚¹ã‚¯ã‚’ã—ãªã„ã¨æ©Ÿå«ŒãŒä¸‹ãŒã‚Šã¾ã™</p>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}